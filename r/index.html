<!DOCTYPE html>
<html lang="en">
<head>
    <title>QRoll</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">   
    <link rel="stylesheet" href="/QRoll/style/main.css">
    <script src="/QRoll/scripts/interactions.js"></script>
</head>  
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<header>
    <h1 class="logo">QRoll | You got Rickrolled</h1>
    <h1 class="logo-mobile">QRoll</h1>
    <a href="/QRoll/" class="icon" onclick="mobnav()">
        <i class="fa fa-home"></i>
      </a>
	<nav>
	<nav>
		<ul class="nav-area top-nav">
			<li><a href="/QRoll/">Home</a></li>
		</ul>
	</nav>
</header> 
<body>     
<div class="container">
    <h1 align="center">Never Gonna Give You Up</h1>
    <p align="center" id="holder" style="display: none">The video has finished, report the QRoll with the form</p>
    <p align="center" id="stop" style="display: none">The video has been stopped due to input</p>
    <p align="center"><iframe id="yt-embed" src="https://www.youtube-nocookie.com/embed/dQw4w9WgXcQ?controls=0&autoplay=1&fs=0&modestbranding=1&disablekb=1&end=60" title="YouTube video player" frameborder="0" allow="autoplay; encrypted-media; picture-in-picture;" allowfullscreen></iframe></p>
</div>
<div class="container">
    <h1 align="center">Please report your finding!</h1>
    <form action="" id="QRForm">    
        <div class="row">    
    
        <div class="row">    
          <div class="col-25">    
            <label for="code">Code</label>    
          </div>    
          <div class="col-75">    
            <!-- TODO Fetch codes from DB -->
            <input id="code" type="tel" maxlength="3" size="3" pattern="[0-9]{3}" placeholder="Please enter the 3 digit code found on the QRoll" required>
            <p id="idnone" style="display: none;">The code is absent or unreadable</p>
          </div>
        </div>    
        <div class="row">
          <div class="col-25">    
            <label for="Location">Location</label>
          </div>    
          <div class="col-75">    
            <textarea id="subject" maxlength="1200" name="body" placeholder="Please describe where you found the QRoll, use an address and reference points, or even better use geographical cordinates" style="height:200px"></textarea>    
          </div>
        </div>    
        <div class="row">
            <input class="home-btn" type="submit" value="Send">    
            <p id="switchoff" style="display: none;">
              Can't find the code? <a onclick="toggleimg()">close reference</a>
            </p>
            <p id="switchon">
              Can't find the code? <a onclick="toggleimg()">open reference</a>
            </p>
            <div id="qrimg" style="display: none;">
              <img class="qrimg" src="/QRoll/assets/qrref.png" alt="QRCode"">
              <p><a id="noidmode" onclick="noid()">The code is absent or unreadable?</a></p>
            </div>
          </div>    
        </form>
    </div>
  <script> //Listeners
  // Input handler
  let inputElem = document.getElementById('code');
  inputElem.addEventListener('input', () => {
    if (inputElem.value === '999') {
      noid()
    }
  });  
  // Embed handler
  document.querySelector('input').addEventListener('input', function() {
      document.getElementById("yt-embed").style.display = "none";
      var elem = document.getElementById("yt-embed");
      elem.remove();
      document.getElementById("stop").style.display = "block";
  });
  setTimeout(function() {
    document.getElementById("yt-embed").style.display = "none";
    document.getElementById("holder").style.display = "block";
  }, 60000);
  </script>
<script src="/QRoll/scripts/form.js" type="module"></script>
</div>
<div class="features-grid">
<footer>
    <p id="version">
        vx.x.x - db
    </p>
</footer>
<script>
  fetch('https://vincenzo160.github.io/QRoll/version.json?nocache=' + (new Date()).getTime())
  .then(response => response.json())
  .then(data => {
    var version = data.version;
    document.getElementById('version').innerHTML = version;
  });
</script>
</html>